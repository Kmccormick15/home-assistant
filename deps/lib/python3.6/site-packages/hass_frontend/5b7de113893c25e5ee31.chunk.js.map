{"version":3,"file":"5b7de113893c25e5ee31.chunk.js","sources":["webpack:///5b7de113893c25e5ee31.chunk.js"],"sourcesContent":["(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{625:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__);var app_route=__webpack_require__(89),html_tag=__webpack_require__(0),polymer_element=__webpack_require__(4),app_header=__webpack_require__(154),app_toolbar=__webpack_require__(122),paper_icon_button=__webpack_require__(62),paper_fab=__webpack_require__(237),preact=__webpack_require__(195),ha_app_layout=__webpack_require__(159),paper_card=__webpack_require__(153),paper_input=__webpack_require__(61),ha_config_section=__webpack_require__(200),js_script=__webpack_require__(387);class script_ScriptEditor extends preact.a{constructor(){super();this.onChange=this.onChange.bind(this);this.sequenceChanged=this.sequenceChanged.bind(this)}onChange(ev){this.props.onChange(Object.assign({},this.props.script,{[ev.target.name]:ev.target.value}))}sequenceChanged(sequence){this.props.onChange(Object.assign({},this.props.script,{sequence}))}render({script,isWide,hass,localize}){const{alias,sequence}=script;return Object(preact.c)(\"div\",null,Object(preact.c)(\"ha-config-section\",{\"is-wide\":isWide},Object(preact.c)(\"span\",{slot:\"header\"},alias),Object(preact.c)(\"span\",{slot:\"introduction\"},\"Use scripts to execute a sequence of actions.\"),Object(preact.c)(\"paper-card\",null,Object(preact.c)(\"div\",{class:\"card-content\"},Object(preact.c)(\"paper-input\",{label:\"Name\",name:\"alias\",value:alias,\"onvalue-changed\":this.onChange})))),Object(preact.c)(\"ha-config-section\",{\"is-wide\":isWide},Object(preact.c)(\"span\",{slot:\"header\"},\"Sequence\"),Object(preact.c)(\"span\",{slot:\"introduction\"},\"The sequence of actions of this script.\",Object(preact.c)(\"p\",null,Object(preact.c)(\"a\",{href:\"https://home-assistant.io/docs/scripts/\",target:\"_blank\"},\"Learn more about available actions.\"))),Object(preact.c)(js_script.a,{script:sequence,onChange:this.sequenceChanged,hass:hass,localize:localize})))}}var unmount=__webpack_require__(386),compute_object_id=__webpack_require__(115),compute_state_name=__webpack_require__(28),navigate_mixin=__webpack_require__(81),localize_mixin=__webpack_require__(13);function ha_script_editor_ScriptEditor(mountEl,props,mergeEl){return Object(preact.e)(Object(preact.c)(script_ScriptEditor,props),mountEl,mergeEl)}class ha_script_editor_HaScriptEditor extends Object(localize_mixin.a)(Object(navigate_mixin.a)(polymer_element.a)){static get template(){return html_tag.a`\n    <style include=\"ha-style\">\n      .errors {\n        padding: 20px;\n        font-weight: bold;\n        color: var(--google-red-500);\n      }\n      .content {\n        padding-bottom: 20px;\n      }\n      paper-card {\n        display: block;\n      }\n      .triggers,\n      .script {\n        margin-top: -16px;\n      }\n      .triggers paper-card,\n      .script paper-card {\n        margin-top: 16px;\n      }\n      .add-card paper-button {\n        display: block;\n        text-align: center;\n      }\n      .card-menu {\n        position: absolute;\n        top: 0;\n        right: 0;\n        z-index: 1;\n        color: var(--primary-text-color);\n      }\n      .card-menu paper-item {\n        cursor: pointer;\n      }\n      span[slot=introduction] a {\n        color: var(--primary-color);\n      }\n      paper-fab {\n        position: fixed;\n        bottom: 16px;\n        right: 16px;\n        z-index: 1;\n        margin-bottom: -80px;\n        transition: margin-bottom .3s;\n      }\n\n      paper-fab[is-wide] {\n        bottom: 24px;\n        right: 24px;\n      }\n\n      paper-fab[dirty] {\n        margin-bottom: 0;\n      }\n    </style>\n    <ha-app-layout has-scrolling-region=\"\">\n      <app-header slot=\"header\" fixed=\"\">\n        <app-toolbar>\n          <paper-icon-button icon=\"hass:arrow-left\" on-click=\"backTapped\"></paper-icon-button>\n          <div main-title=\"\">Script [[name]]</div>\n        </app-toolbar>\n      </app-header>\n      <div class=\"content\">\n        <template is=\"dom-if\" if=\"[[errors]]\">\n          <div class=\"errors\">[[errors]]</div>\n        </template>\n        <div id=\"root\"></div>\n      </div>\n      <paper-fab slot=\"fab\" is-wide$=\"[[isWide]]\" dirty$=\"[[dirty]]\" icon=\"hass:content-save\" title=\"Save\" on-click=\"saveScript\"></paper-fab>\n    </ha-app-layout>\n`}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},errors:{type:Object,value:null},dirty:{type:Boolean,value:!1},config:{type:Object,value:null},script:{type:Object,observer:\"scriptChanged\"},creatingNew:{type:Boolean,observer:\"creatingNewChanged\"},name:{type:String,computed:\"computeName(script)\"},isWide:{type:Boolean,observer:\"_updateComponent\"},_rendered:{type:Object,value:null},_renderScheduled:{type:Boolean,value:!1}}}ready(){this.configChanged=this.configChanged.bind(this);super.ready()}disconnectedCallback(){super.disconnectedCallback();if(this._rendered){Object(unmount.a)(this._rendered);this._rendered=null}}configChanged(config){if(null===this._rendered)return;this.config=config;this.errors=null;this.dirty=!0;this._updateComponent()}scriptChanged(newVal,oldVal){if(!newVal)return;if(!this.hass){setTimeout(()=>this.scriptChanged(newVal,oldVal),0);return}if(oldVal&&oldVal.entity_id===newVal.entity_id){return}this.hass.callApi(\"get\",\"config/script/config/\"+Object(compute_object_id.a)(newVal.entity_id)).then(config=>{var value=config.sequence;if(value&&!Array.isArray(value)){config.sequence=[value]}this.dirty=!1;this.config=config;this._updateComponent()},()=>{alert(\"Only scripts inside scripts.yaml are editable.\");history.back()})}creatingNewChanged(newVal){if(!newVal){return}this.dirty=!1;this.config={alias:\"New Script\",sequence:[{service:\"\",data:{}}]};this._updateComponent()}backTapped(){if(this.dirty&&!confirm(\"You have unsaved changes. Are you sure you want to leave?\")){return}history.back()}_updateComponent(){if(this._renderScheduled||!this.hass||!this.config)return;this._renderScheduled=!0;Promise.resolve().then(()=>{this._rendered=ha_script_editor_ScriptEditor(this.$.root,{script:this.config,onChange:this.configChanged,isWide:this.isWide,hass:this.hass,localize:this.localize},this._rendered);this._renderScheduled=!1})}saveScript(){var id=this.creatingNew?\"\"+Date.now():Object(compute_object_id.a)(this.script.entity_id);this.hass.callApi(\"post\",\"config/script/config/\"+id,this.config).then(()=>{this.dirty=!1;if(this.creatingNew){this.navigate(`/config/script/edit/${id}`,!0)}},errors=>{this.errors=errors.body.message;throw errors})}computeName(script){return script&&Object(compute_state_name.a)(script)}}customElements.define(\"ha-script-editor\",ha_script_editor_HaScriptEditor);var paper_item_body=__webpack_require__(198),paper_item=__webpack_require__(120);class ha_script_picker_HaScriptPicker extends Object(localize_mixin.a)(Object(navigate_mixin.a)(polymer_element.a)){static get template(){return html_tag.a`\n    <style include=\"ha-style\">\n      :host {\n        display: block;\n      }\n\n      paper-item {\n        cursor: pointer;\n      }\n\n      paper-fab {\n        position: fixed;\n        bottom: 16px;\n        right: 16px;\n        z-index: 1;\n      }\n\n      paper-fab[is-wide] {\n        bottom: 24px;\n        right: 24px;\n      }\n\n      a {\n        color: var(--primary-color);\n      }\n    </style>\n\n    <ha-app-layout has-scrolling-region=\"\">\n      <app-header slot=\"header\" fixed=\"\">\n        <app-toolbar>\n          <paper-icon-button icon=\"hass:arrow-left\" on-click=\"_backTapped\"></paper-icon-button>\n          <div main-title=\"\">[[localize('ui.panel.config.script.caption')]]</div>\n        </app-toolbar>\n      </app-header>\n\n      <ha-config-section is-wide=\"[[isWide]]\">\n        <div slot=\"header\">Script Editor</div>\n        <div slot=\"introduction\">\n          The script editor allows you to create and edit scripts.\n          Please read <a href=\"https://home-assistant.io/docs/scripts/editor/\" target=\"_blank\">the instructions</a> to make sure that you have configured Home Assistant correctly.\n        </div>\n\n        <paper-card heading=\"Pick script to edit\">\n          <template is=\"dom-if\" if=\"[[!scripts.length]]\">\n            <div class=\"card-content\">\n              <p>We couldn't find any editable scripts.</p>\n            </div>\n          </template>\n          <template is=\"dom-repeat\" items=\"[[scripts]]\" as=\"script\">\n            <paper-item>\n              <paper-item-body two-line=\"\" on-click=\"scriptTapped\">\n                <div>[[computeName(script)]]</div>\n                <div secondary=\"\">[[computeDescription(script)]]</div>\n              </paper-item-body>\n              <iron-icon icon=\"hass:chevron-right\"></iron-icon>\n            </paper-item>\n          </template>\n        </paper-card>\n      </ha-config-section>\n\n      <paper-fab slot=\"fab\" is-wide$=\"[[isWide]]\" icon=\"hass:plus\" title=\"Add Script\" on-click=\"addScript\"></paper-fab>\n    </ha-app-layout>\n`}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},scripts:{type:Array},isWide:{type:Boolean}}}scriptTapped(ev){this.navigate(\"/config/script/edit/\"+this.scripts[ev.model.index].entity_id)}addScript(){this.navigate(\"/config/script/new\")}computeName(script){return Object(compute_state_name.a)(script)}computeDescription(){return\"\"}_backTapped(){history.back()}}customElements.define(\"ha-script-picker\",ha_script_picker_HaScriptPicker);var compute_state_domain=__webpack_require__(22);class ha_config_script_HaConfigScript extends polymer_element.a{static get template(){return html_tag.a`\n    <style>\n      ha-script-picker,\n      ha-script-editor {\n        height: 100%;\n      }\n    </style>\n    <app-route route=\"[[route]]\" pattern=\"/script/edit/:script\" data=\"{{_routeData}}\" active=\"{{_edittingScript}}\"></app-route>\n    <app-route route=\"[[route]]\" pattern=\"/script/new\" active=\"{{_creatingNew}}\"></app-route>\n\n    <template is=\"dom-if\" if=\"[[!showEditor]]\">\n      <ha-script-picker hass=\"[[hass]]\" narrow=\"[[narrow]]\" show-menu=\"[[showMenu]]\" scripts=\"[[scripts]]\" is-wide=\"[[isWide]]\"></ha-script-picker>\n    </template>\n\n    <template is=\"dom-if\" if=\"[[showEditor]]\" restamp=\"\">\n      <ha-script-editor hass=\"[[hass]]\" script=\"[[script]]\" is-wide=\"[[isWide]]\" creating-new=\"[[_creatingNew]]\"></ha-script-editor>\n    </template>\n`}static get properties(){return{hass:Object,narrow:Boolean,showMenu:Boolean,route:Object,isWide:Boolean,_routeData:Object,_routeMatches:Boolean,_creatingNew:Boolean,_edittingScript:Boolean,scripts:{type:Array,computed:\"computeScripts(hass)\"},script:{type:Object,computed:\"computeScript(scripts, _edittingScript, _routeData)\"},showEditor:{type:Boolean,computed:\"computeShowEditor(_edittingScript, _creatingNew)\"}}}computeScript(scripts,edittingAddon,routeData){if(!scripts||!edittingAddon){return null}for(var i=0;i<scripts.length;i++){if(scripts[i].entity_id===routeData.script){return scripts[i]}}return null}computeScripts(hass){var scripts=[];Object.keys(hass.states).forEach(function(key){var entity=hass.states[key];if(\"script\"===Object(compute_state_domain.a)(entity)){scripts.push(entity)}});return scripts.sort(function(entityA,entityB){var nameA=Object(compute_state_name.a)(entityA),nameB=Object(compute_state_name.a)(entityB);if(nameA<nameB){return-1}if(nameA>nameB){return 1}return 0})}computeShowEditor(_edittingScript,_creatingNew){return _creatingNew||_edittingScript}}customElements.define(\"ha-config-script\",ha_config_script_HaConfigScript)}}]);"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourceRoot":""}