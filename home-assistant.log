2018-10-03 08:40:15 WARNING (MainThread) [homeassistant.components.http] legacy_api_password support has been enabled. If you don't require it, remove the 'api_password' from your http config.
2018-10-03 08:43:09 WARNING (MainThread) [homeassistant.components.sensor.template] Could not render template Theater, the state is unknown.
2018-10-03 08:43:29 WARNING (SyncWorker_9) [netdisco.ssdp] Error fetching description at http://192.168.1.238:1990/WFADevice.xml
2018-10-03 10:41:39 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 10:58:58 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 13:03:53 ERROR (MainThread) [homeassistant.components.tts.google] Error 500 on load url https://translate.google.com/translate_tts?ie=UTF-8&tl=en&q='Someone+might+be+here.+'&tk=117402.479203&total=1&idx=0&client=tw-ob&textlen=25
2018-10-03 13:03:53 ERROR (MainThread) [homeassistant.components.tts] Error on init TTS: No TTS from google for ''Someone might be here. ''
2018-10-03 16:58:50 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 17:03:32 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 18:45:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.btc_exchange_rate fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 600, in urlopen
    chunked=chunked)
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 384, in _make_request
    six.raise_from(e, None)
  File "<string>", line 2, in raise_from
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 380, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.6/http/client.py", line 1331, in getresponse
    response.begin()
  File "/usr/local/lib/python3.6/http/client.py", line 297, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.6/http/client.py", line 258, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.6/socket.py", line 586, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/lib/python3.6/ssl.py", line 1009, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 871, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 631, in read
    v = self._sslobj.read(len, buffer)
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/requests/adapters.py", line 445, in send
    timeout=timeout
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 638, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/usr/local/lib/python3.6/site-packages/urllib3/util/retry.py", line 367, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.6/site-packages/urllib3/packages/six.py", line 685, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 600, in urlopen
    chunked=chunked)
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 384, in _make_request
    six.raise_from(e, None)
  File "<string>", line 2, in raise_from
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 380, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.6/http/client.py", line 1331, in getresponse
    response.begin()
  File "/usr/local/lib/python3.6/http/client.py", line 297, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.6/http/client.py", line 258, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.6/socket.py", line 586, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/lib/python3.6/ssl.py", line 1009, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 871, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 631, in read
    v = self._sslobj.read(len, buffer)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/coinbase.py", line 140, in update
    self._coinbase_data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/coinbase.py", line 86, in update
    self.accounts = self.client.get_accounts()
  File "/usr/local/lib/python3.6/site-packages/coinbase/wallet/client.py", line 237, in get_accounts
    response = self._get('v2', 'accounts', params=params)
  File "/usr/local/lib/python3.6/site-packages/coinbase/wallet/client.py", line 129, in _get
    return self._request('get', *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/coinbase/wallet/client.py", line 115, in _request
    response = getattr(self.session, method)(uri, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 525, in get
    return self.request('GET', url, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 512, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 622, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/adapters.py", line 495, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))
2018-10-03 18:46:37 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.coinbase_btc_wallet fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 600, in urlopen
    chunked=chunked)
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 384, in _make_request
    six.raise_from(e, None)
  File "<string>", line 2, in raise_from
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 380, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.6/http/client.py", line 1331, in getresponse
    response.begin()
  File "/usr/local/lib/python3.6/http/client.py", line 297, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.6/http/client.py", line 258, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.6/socket.py", line 586, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/lib/python3.6/ssl.py", line 1009, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 871, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 631, in read
    v = self._sslobj.read(len, buffer)
ConnectionResetError: [Errno 104] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/requests/adapters.py", line 445, in send
    timeout=timeout
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 638, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/usr/local/lib/python3.6/site-packages/urllib3/util/retry.py", line 367, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.6/site-packages/urllib3/packages/six.py", line 685, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 600, in urlopen
    chunked=chunked)
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 384, in _make_request
    six.raise_from(e, None)
  File "<string>", line 2, in raise_from
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 380, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.6/http/client.py", line 1331, in getresponse
    response.begin()
  File "/usr/local/lib/python3.6/http/client.py", line 297, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.6/http/client.py", line 258, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.6/socket.py", line 586, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/lib/python3.6/ssl.py", line 1009, in recv_into
    return self.read(nbytes, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 871, in read
    return self._sslobj.read(len, buffer)
  File "/usr/local/lib/python3.6/ssl.py", line 631, in read
    v = self._sslobj.read(len, buffer)
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/coinbase.py", line 88, in update
    self._coinbase_data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/coinbase.py", line 86, in update
    self.accounts = self.client.get_accounts()
  File "/usr/local/lib/python3.6/site-packages/coinbase/wallet/client.py", line 237, in get_accounts
    response = self._get('v2', 'accounts', params=params)
  File "/usr/local/lib/python3.6/site-packages/coinbase/wallet/client.py", line 129, in _get
    return self._request('get', *args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/coinbase/wallet/client.py", line 115, in _request
    response = getattr(self.session, method)(uri, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 525, in get
    return self.request('GET', url, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 512, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 622, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/adapters.py", line 495, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', ConnectionResetError(104, 'Connection reset by peer'))
2018-10-03 19:57:07 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 20:01:36 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 20:27:53 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 20:57:09 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 21:40:45 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-03 23:35:33 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 06:07:05 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 07:47:11 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 08:07:17 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 09:38:33 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 10:25:40 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 15:54:18 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.btc_exchange_rate is taking over 10 seconds
2018-10-04 16:24:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:24:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:24 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:41 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:49 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:25:56 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:12 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:16 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:21 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:48 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:51 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:26:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:31 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:27:49 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:21 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:24 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:28:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:21 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:24 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:39 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:51 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:29:55 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:25 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:29 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:43 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:55 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:30:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:25 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:27 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:30 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:32 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:53 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:56 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:31:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:01 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:27 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:30 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:31 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:33 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:32:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:01 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:29 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:30 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:32 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:33 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:33:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:01 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:05 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:31 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:32 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:37 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:56 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:34:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:05 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:30 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:33 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:37 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:39 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:35:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:05 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:23 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 16:36:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:36:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:25 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_humidity is taking over 10 seconds
2018-10-04 16:37:25 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:35 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.bedroom_temperature is taking over 10 seconds
2018-10-04 16:37:36 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 16:37:36 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:37:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:39 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:41 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:43 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:38:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:39:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:39:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:39:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:39:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:39:33 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_humidity is taking over 10 seconds
2018-10-04 16:39:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:39:39 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 16:39:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:24 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:45 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:48 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:40:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:16 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:45 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:49 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:41:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:21 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:49 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:42:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:30 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:43:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:05 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:53 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:44:56 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:21 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:25 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:27 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:55 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:45:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:25 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:29 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:55 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:46:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:25 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:30 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:31 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:56 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:47:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:27 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:29 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:30 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:32 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:48:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:01 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:29 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:31 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:33 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:36 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:49:59 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 16:50:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:05 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:31 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:33 ERROR (MainThread) [homeassistant.core] Timer got out of sync. Resetting
2018-10-04 16:50:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:36 ERROR (MainThread) [homeassistant.core] Timer got out of sync. Resetting
2018-10-04 16:50:37 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:39 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:40 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:50:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:02 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:12 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:29 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:32 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:37 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:51:45 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:01 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:32 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:34 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:36 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:37 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:40 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:41 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:52:48 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:36 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:40 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:41 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:53:44 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 16:53:52 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:06 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:12 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:24 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:39 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:54:55 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:12 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:27 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:40 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:43 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:55:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:12 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:16 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:29 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:40 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:41 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:43 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:45 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:56:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:01 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:33 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:41 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:43 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:44 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:57:49 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:05 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:09 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 16:58:12 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:21 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:37 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:43 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:45 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:48 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:50 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:58:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:14 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:16 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:25 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:41 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:45 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:46 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:48 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:49 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:51 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 16:59:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:16 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:17 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:22 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:32 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:00:48 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:01:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:01:19 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:01:35 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:01:53 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:02:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:02:23 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:02:39 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:02:54 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:02:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:03:03 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:03:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:03:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:03:24 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:03:42 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:03:56 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:04:00 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:04:05 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:04:10 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:04:16 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:04:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:04:47 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:04:58 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:05:07 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:05:17 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.living_room_temperature is taking over 10 seconds
2018-10-04 17:05:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:05:24 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:05:26 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:05:33 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:05:51 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:05:59 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:06:04 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:06:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:06:13 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 17:06:15 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:06:20 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:06:28 ERROR (MainThread) [homeassistant.helpers.entity] Update for climate.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/climate/ecobee.py", line 134, in update
    self.data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:06:38 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:06:57 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:07:16 WARNING (MainThread) [homeassistant.helpers.entity] Update of weather.thermostat is taking over 10 seconds
2018-10-04 17:07:16 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:07:31 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 17:07:48 WARNING (MainThread) [homeassistant.helpers.entity] Update of weather.thermostat is taking over 10 seconds
2018-10-04 17:07:54 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:08:10 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:08:26 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:08:42 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:08:58 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:09:14 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:09:30 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:09:46 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:09:49 WARNING (SyncWorker_10) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.Could not request pin.
2018-10-04 17:13:08 WARNING (MainThread) [homeassistant.helpers.entity] Update of weather.thermostat is taking over 10 seconds
2018-10-04 17:13:14 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:13:30 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:13:46 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:14:02 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:14:18 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:14:34 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:14:50 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:15:05 WARNING (SyncWorker_12) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:18:28 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.bedroom_temperature is taking over 10 seconds
2018-10-04 17:18:49 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:19:20 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:19:51 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:20:22 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:20:25 WARNING (SyncWorker_18) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:23:37 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.nolans_room_temperature is taking over 10 seconds
2018-10-04 17:23:58 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:24:29 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:25:00 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:25:31 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:25:34 WARNING (SyncWorker_13) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:28:47 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.bedroom_temperature is taking over 10 seconds
2018-10-04 17:29:08 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:29:39 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:30:10 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:30:41 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:30:44 WARNING (SyncWorker_1) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:33:55 WARNING (MainThread) [homeassistant.helpers.entity] Update of weather.thermostat is taking over 10 seconds
2018-10-04 17:34:01 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:34:17 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:34:33 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:34:49 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:35:05 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:35:21 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:35:37 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:35:52 WARNING (SyncWorker_3) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:39:05 WARNING (MainThread) [homeassistant.helpers.entity] Update of climate.thermostat is taking over 10 seconds
2018-10-04 17:39:56 WARNING (MainThread) [homeassistant.components.climate] Updating ecobee climate took longer than the scheduled update interval 0:01:00
2018-10-04 17:40:57 WARNING (MainThread) [homeassistant.components.climate] Updating ecobee climate took longer than the scheduled update interval 0:01:00
2018-10-04 17:41:02 WARNING (SyncWorker_17) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:44:17 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_temperature is taking over 10 seconds
2018-10-04 17:44:38 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:45:09 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:45:40 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:46:11 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:46:14 WARNING (SyncWorker_12) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:49:27 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_temperature is taking over 10 seconds
2018-10-04 17:49:48 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:50:19 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:50:50 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:51:21 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 17:51:26 WARNING (SyncWorker_3) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:52:42 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 17:53:27 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 17:54:39 WARNING (MainThread) [homeassistant.helpers.entity] Update of weather.thermostat is taking over 10 seconds
2018-10-04 17:54:45 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:55:00 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:55:16 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:55:31 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:55:47 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:56:03 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:56:19 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:56:35 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 17:56:36 WARNING (SyncWorker_15) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 17:59:56 WARNING (MainThread) [homeassistant.helpers.entity] Update of weather.thermostat is taking over 10 seconds
2018-10-04 18:00:02 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:00:18 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:00:34 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:00:50 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:01:06 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:01:22 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:01:38 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:01:53 WARNING (SyncWorker_4) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:05:16 WARNING (MainThread) [homeassistant.helpers.entity] Update of weather.thermostat is taking over 10 seconds
2018-10-04 18:05:22 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:05:38 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:05:54 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:06:10 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:06:26 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:06:42 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:06:58 WARNING (MainThread) [homeassistant.components.weather] Updating ecobee weather took longer than the scheduled update interval 0:00:15
2018-10-04 18:07:13 WARNING (SyncWorker_4) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:10:33 WARNING (MainThread) [homeassistant.helpers.entity] Update of climate.thermostat is taking over 10 seconds
2018-10-04 18:11:24 WARNING (MainThread) [homeassistant.components.climate] Updating ecobee climate took longer than the scheduled update interval 0:01:00
2018-10-04 18:12:25 WARNING (MainThread) [homeassistant.components.climate] Updating ecobee climate took longer than the scheduled update interval 0:01:00
2018-10-04 18:12:30 WARNING (SyncWorker_19) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:15:23 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 18:15:44 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.bedroom_temperature is taking over 10 seconds
2018-10-04 18:16:05 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:16:36 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:17:06 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:17:21 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 18:17:37 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:17:41 WARNING (SyncWorker_9) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:20:53 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_humidity is taking over 10 seconds
2018-10-04 18:21:14 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:21:45 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:22:16 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:22:47 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:22:50 WARNING (SyncWorker_8) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:26:03 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.bedroom_temperature is taking over 10 seconds
2018-10-04 18:26:24 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:26:55 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:27:26 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:27:57 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:28:00 WARNING (SyncWorker_10) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:31:12 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.bedroom_temperature is taking over 10 seconds
2018-10-04 18:31:33 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:32:04 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:32:35 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:33:06 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:33:09 WARNING (SyncWorker_3) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:35:38 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 18:36:21 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.living_room_temperature is taking over 10 seconds
2018-10-04 18:36:42 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:37:13 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:37:44 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:38:15 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:38:18 WARNING (SyncWorker_5) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:41:31 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.nolans_room_temperature is taking over 10 seconds
2018-10-04 18:41:52 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:42:23 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:42:54 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:43:25 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:43:28 WARNING (SyncWorker_8) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:46:41 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_temperature is taking over 10 seconds
2018-10-04 18:47:02 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:47:33 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:48:04 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:48:35 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:48:38 WARNING (SyncWorker_12) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:51:51 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.bedroom_temperature is taking over 10 seconds
2018-10-04 18:52:12 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:52:43 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:53:14 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:53:45 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:53:48 WARNING (SyncWorker_15) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 18:57:01 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.living_room_temperature is taking over 10 seconds
2018-10-04 18:57:22 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:57:53 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:58:23 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:58:54 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 18:58:58 WARNING (SyncWorker_11) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 19:02:10 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_humidity is taking over 10 seconds
2018-10-04 19:02:31 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:03:02 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:03:33 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:04:03 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:04:07 WARNING (SyncWorker_13) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 19:07:19 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.living_room_temperature is taking over 10 seconds
2018-10-04 19:07:40 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:08:11 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:08:42 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:09:13 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:09:16 WARNING (SyncWorker_14) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 19:12:29 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_humidity is taking over 10 seconds
2018-10-04 19:12:50 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:13:21 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:13:52 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:14:23 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:14:26 WARNING (SyncWorker_17) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 19:17:37 WARNING (MainThread) [homeassistant.helpers.entity] Update of sensor.thermostat_temperature is taking over 10 seconds
2018-10-04 19:17:58 WARNING (MainThread) [homeassistant.components.sensor] Updating ecobee sensor took longer than the scheduled update interval 0:00:30
2018-10-04 19:18:08 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 19:18:09 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.bedroom_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 19:18:11 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.living_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 19:18:12 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.nolans_room_temperature fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 19:18:13 ERROR (MainThread) [homeassistant.helpers.entity] Update for sensor.thermostat_humidity fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/sensor/ecobee.py", line 76, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 19:18:18 ERROR (MainThread) [homeassistant.helpers.entity] Update for weather.thermostat fails
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 223, in async_update_ha_state
    yield from self.async_device_update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/helpers/entity.py", line 352, in async_device_update
    yield from self.hass.async_add_job(self.update)
  File "/usr/local/lib/python3.6/concurrent/futures/thread.py", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/weather/ecobee.py", line 167, in update
    data.update()
  File "/usr/local/lib/python3.6/site-packages/homeassistant/util/__init__.py", line 324, in wrapper
    result = method(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/homeassistant/components/ecobee.py", line 98, in update
    self.ecobee.update()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 185, in update
    self.get_thermostats()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 158, in get_thermostats
    if self.refresh_tokens():
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 130, in refresh_tokens
    self.request_pin()
  File "/usr/local/lib/python3.6/site-packages/pyecobee/__init__.py", line 88, in request_pin
    self.authorization_code = request.json()['code']
KeyError: 'code'
2018-10-04 19:18:27 WARNING (SyncWorker_8) [pyecobee] Error connecting to Ecobee.  Possible connectivity outage.
2018-10-04 20:16:22 WARNING (MainThread) [homeassistant.core] Unable to find service media_player/play_media
2018-10-04 21:36:23 ERROR (MainThread) [frontend.js.latest.201809270] :0:0 Script error.
